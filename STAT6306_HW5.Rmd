---
title: "STAT 6306 HW5"
output: 
  html_document: 
    keep_md: yes
---
##Name: Kevin Kyoo Ha Cha
##Let's Download and tidying GDP data first
##We will download and merge educational data later
required package: plyr, Hmisc

```{r}

fileURL <- "https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FGDP.csv"
gdp <- read.csv(url(fileURL), header=T)
names(gdp)
head(gdp)
```

```{r}
#remove first 4 rows in this csv file
gdp <-read.csv(url(fileURL),skip=4)#now it is better
head(gdp)
```

##It looks little bit better, but we can do more tidying as naming varialbes rather than x1, x2 etc..
##We will determine how many NAs as well as excluding them
##We will also convert the data type from character to numeric for a variable, GDP

```{r}
#when you see the bottom of this csv file, there are paragraphs so we have problem
#so when r see these characters to goes
gdp <-read.csv(url(fileURL),skip=4, na.strings=c("..","Not available.",".. Not available."),stringsAsFactors=FALSE)
str(gdp)#it looks little better

#let's get rid of NA
gdp <- dplyr::select(gdp, X,X.1,X.3,X.4)
str(gdp)

#need to make dollar and ranking numeric now
names(gdp) <- c("CountryCode", "Ranking", "Economy", "GDP")
str(gdp) #it is better now.
gdp$Ranking <- as.numeric(gdp$Ranking)#we'll have problem so look at the last 40 rows
tail(gdp,40)#so we have many NAs so which is a problem
sum(is.na(gdp$Ranking))
dim(gdp)
326-136
gdp[180:200,] #we see NAs starting from 191, the data is not meaningful, we will delete NAs
summary(gdp[191:326,]) #so we only have many many NAs, we confirm that we should delete NAs
gdp <- gdp[1:190,]
str(gdp)

#then, now lets change ranking to numeric variable 
gdp$Ranking <- as.numeric(gdp$Ranking)
str(gdp)
tail(gdp, 40)
sum(is.na(gdp$Ranking)) #there are 136 NAs
dim(gdp)
326-136 #there are 190 rows WITHOUT  NAs
gdp[180:200,] #Just want to double check
summary (gdp[191:326,]) #to make sure it is alll NAs
gdp <- gdp[1:190,] #set gdp data without NAs, this is the same as above steps
str(gdp)
gdp2 <- gdp
gdp2$GDP <- gsub("," , "" ,gdp2$GDP)
gdp2$GDP <- as.numeric(gdp2$GDP)
str(gdp2)
#we had all NAs because of the commas on numbers (i.e. $65,000), we neet to remove them, try it on your test dataset gdp2
#we also convert from character to numeric on GDP data
gdp$GDP <- gsub("," , "" ,gdp$GDP)
str(gdp)
gdp$GDP <- as.numeric(gdp$GDP)
str(gdp)
#we can use either gdp or gdp2 data because I tried something differnt before, but
#changed back to make both gdp and gdp2 are identical 
#######################################################################################
```

##Answering HW Questions..
##Question1
```{r}
#download and tidying educational data 
fileURL <- "https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FEDSTATS_Country.csv"
edu <- read.csv(url(fileURL))
names(edu)
head(edu)
summary(edu)
#Merge data by country codes
matchedData <- merge(gdp2, edu, by.x = "CountryCode", by.y = "CountryCode")
head(matchedData)
#Number of matched countries
dim(matchedData)[1]
```

There are 189 matched IDs

##Question 2
```{r}
#Sort the data by GDP so United States is last
require(plyr)
arrange(matchedData,desc(Ranking))[13,1:4]
```

The 13th country is KNA with GDP 767.

##Question 3
```{r}
#Subset "High income: OECD" and calculate the mean GDP Ranking
mean(subset(matchedData, Income.Group %in% "High income: OECD", select = c(Ranking))$Ranking)

#Subset "High income: nonOECD" and calculate the mean GDP Ranking
mean(subset(matchedData, Income.Group %in% "High income: nonOECD", select = c(Ranking))$Ranking)
```

Average GDP ranking for "High income: OECD" is 32.96667

Average GDP ranking for "High Income: nonOECD" is 91.91304

##Question 4
```{r}
require(Hmisc)
#Cut Ranks into 5 groups and store as factor variable
matchedData$Rank.Groups = cut2(matchedData$Rank, g = 5)
#Build a table of Income Groups across Rank Groups
table(matchedData$Income.Group, matchedData$Rank.Groups)
```

There are 5 countries with lower middle income but among the 38 nations with highest GDP

##Question 5
There are 136 NAs determined by sum(is.na(gdp$Ranking)), then I calculate the number of rows without NAs and it is 190 rows (326-136). I use gdp[180:200,] to see how the data looks like and I see NAs from line 191 to the end.

I used summary(gdp[191:326,]) to see how many NAs in order to confirm my findings above.
I renamed the data, gdp, containing only values without NAs using gdp <- gdp[1:190,]
See from line 24 to 56 to see how we tidying the gdp data.








```

